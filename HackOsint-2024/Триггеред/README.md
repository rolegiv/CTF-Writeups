# Триггеред (RE, Medium+) by [w33d](https://github.com/w3irdd)

# Задание

![image](https://github.com/rolegiv/CTF-Writeups/assets/147992165/0bb8ed9e-235a-4e49-92fe-33454eb91e3c)

# Решение

Начинаем реверсить. Пройдясь дебагом, находим функцию, которая вызывает BSOD.

![image](https://github.com/rolegiv/CTF-Writeups/assets/147992165/7bb71491-0c9c-477d-b43f-8d0a5dc701b3)

Заглядываем внутрь sub_402880 и видим огромное кол-во условий, чтобы миновать BSOD, почти все они связаны с функциями антиотладки, а также с наличием определенных запущенных окон. Попытка запуска с ScyllaHide не увенчалась успехом, поэтому попытаемся просто отредактировать бинарник. Поменяем инструкцию jz short (jump if zero) на jmp, т.е безусловный переход. Для этого в HEX-редакторе найдем конструкцию 74 05 (jz short) и поменяем ее на EB 05 (jmp).

![image](https://github.com/rolegiv/CTF-Writeups/assets/147992165/f7a22126-b12d-488b-b591-3138e6045710)

Отлично, теперь программа работает и даже просит на ввод логин и пароль. Пробуем логин и пароь, найденные в бинаре, но программа пускать дальше нас не хочет. При дебагинге обнаруживаем, что есть блок команд, в который программа не заходит при любых комбинациях логина и пароля. Брутить их идея так себе, поэтому сделаем также, как и раньше. Найдем опкод jz и заменим его на jnz. Теперь мы попали в нужный нам блок кода! Сначала, может показаться, что ничего не происходит... но если мы наденем наушники, то услышим, что функция настукивает нам азбуку морзе! 
Записываем звук и раскатываем в Audacity.

![image](https://github.com/rolegiv/CTF-Writeups/assets/147992165/b3877949-9279-4ab5-9833-038d8c25ff31)

# Флаг
**B0NU${R3V3R2EDW0W}**
